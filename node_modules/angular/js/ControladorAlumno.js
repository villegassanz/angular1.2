(function() {
    angular.module("tbcAngular").controller("AlumnoCtrl", AlumnoController);

    function AlumnoController(servicioalumno) {
        var vm = this;
        vm.getAlumnos = getAlumnos;
        vm.getAlumnoById = getAlumnoById;
        vm.updateAlumno = updateAlumno;
        vm.agregarAlumno = agregarAlumno;
        vm.Init = Init;
        vm.datos_alumnos = [];
        vm.id = "";
        vm.alumno = {};
        vm.addAlumno = {};
        vm.objAlumno = {};
        vm.login=login;
        vm.pdf=pdf;
        vm.loginActivo=false;
        vm.valor=false;
        vm.log=[];
        vm.entrar=false;
        vm.mostrarDatos=false;
        vm.valMosAlumno=true;

        Init();
        function Init() {
            getAlumnos();
        }

        function login() {
            console.log(vm.user +'--'+vm.password);
            servicioalumno.login(vm.user, vm.password).then(function(data) {
                vm.log = data;
                 vm.loginActivo=true;
                 vm.entrar=true;
                console.log(vm.log);
            });
        }
        function pdf() {
            pdfMake.fonts = {
                Calibri: {
                    normal: 'Calibri-Regular.ttf',
                    bold: 'Calibri-Bold.ttf'
                        //italics: 'fontFile3.ttf',
                        //bolditalics: 'fontFile4.ttf'
                },
                Roboto: {
                    normal: 'Roboto-Regular.ttf',
                    bold: 'Roboto-Medium.ttf',
                    italics: 'Roboto-Italic.ttf',
                    bolditalics: 'Roboto-Italic.ttf'
                }
            }
            var pdf_salida = {
                content: [
        
        {   
           fontSize: 8,
            margin: [0, 0, 0, 0],
            //alignment: 'center',
            table: {
                     widths: ['20%','20%', '20%','20%', '20%'],
                body: [
                    [{
                        text: ' ', border: [true, true, true, true],
                         fontSize: 10, margin: [0, 15, 0, 0],
                    }
                        ,{
                        text: '', border: [true, true, true, true],
                         fontSize: 10, margin: [0, 15, 0, 0],
                    },
                    {
                        text: ' ',
                        border: [true, true, true, true],
                            fontSize: 10,
                        bold: true,
                    },
                     {
                        text: ' ',  border: [true, true, true, true],
                    },
                    {
                        text: ' ',  border: [true, true, true, true],
                    },
                    
                    ]
                ]
            }
        },
    ]

            };
            pdfMake.createPdf(pdf_salida).open();
        }

        function getAlumnos() {
            console.log("Alumnos");
            servicioalumno.getAlumno().then(function(data) {
                vm.datos_alumnos = data;
                console.log(vm.datos_alumnos);
            }).catch(function(err) {});
        }

        function getAlumnoById(id) {
            servicioalumno.getAlumnoById(id).then(function(data) {
                vm.alumno = data[0];
                vm.valor=true;
                console.log(vm.alumno);
            }).catch(function(err) {});
        }

        function updateAlumno() {
            console.log(vm.alumno);
            servicioalumno.updateAlumno(vm.alumno).then(function(data) {
                vm.alumno = data;
                getAlumnos();
                vm.valor=false;
                console.log("Se actualizo");
               
            })
        }

        function agregarAlumno(obj) {
            console.log(obj);
            obj.password='12345';
            servicioalumno.addAlumno(obj).then(function(data) {
                vm.addAlumno = data;
                console.log(vm.addAlumno);
            })
        }
    }
})();